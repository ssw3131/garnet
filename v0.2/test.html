<!DOCTYPE html>
<html>
<head lang="ko">
	<!--<meta charset="euc-kr">-->
	<meta charset="utf-8">
	<title></title>
	<script src="garnet.js"></script>
	<meta name="viewport"
	      content="width=device-width,user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,target-densitydpi=medium-dpi" />
	<style>
		.array {
			border-left: 1px dotted blue;
			color: red;
			font-weight: bold;
			padding: 5px 0px 5px 5px
		}

		.obj {
			border-left: 1px dotted blue;
			color: blue;
			font-weight: bold;
			padding: 5px 0px 5px 5px;
		}

		.data {
			padding: 2px 50px 12px 5px;
		}

		html {
			font-size: 12px;
			background-color: #222;
			margin: 0px;
			padding: 0px;
		}

		.testBox {
			box-shadow: 0 0 10px #999 inset, 0 1px 1px rgba(0, 0, 0, 0.1);
			border-radius: 10px;
			overflow-y: scroll;
			background: #eee;
			float: left;
			margin: 8px 8px 0px 0px;
			padding: 10px;
			max-height: 300px;

		}

		.title {
			border-radius: 5px;
			box-shadow: 0 0 3px #ccc inset, 1px 1px 1px rgba(0, 0, 0, 0.1);
			border: 1px solid #fff;
			background-color: #222;
			padding: 10px;
			margin: 0px 0px 10px 0px;
			color: #fff;
			text-shadow: 0 -1px 0 #000;
		}


	</style>
</head>
<body>
<div style="top:0px;">
	<div id="console"></div>
	<div id="stage" class='testBox'>
		<div class="title">쿼리테스트용</div>
		<div width="50%" class="ka" id="a0">d50<a id="aa0">a0</a></div>
		<div width="100%" class="ka" id="a1"><a id="aa1">a1</a>d100</div>
		<input id="i0" type="radio" value="i0" checked>

		<div class="ka" id="a2" class="example"><p><a id="aaa">aaaa</a></p></div>
		<div class="ka" id="a3"><span id="sp3">span3</span></div>
		<p id="p0" data-test="dk-a">dk-a</p>

		<p id="p1" data-test="a dk a">a dk a</p>
		<span id="sp5">span5</span>

		<div class="ka" id="a4"><span id="sp4">span4</span></div>
		<p id="p2" data-test="aaadkaa">aaadkaa</p>

		<p id="p3" data-test="dk">dk</p>

		<p id="p4" data-test="dk"><span>dskdksd</span></p>

		<p id="p5" data-test="dk" lang="it">it</p>
		<span id="sp0">span0</span><span id="sp1">span1</span>
		<i id="i0"><span id="sp2">span2<b id="b0"></b></span></i>
		<i id="i1"><b id="b1" data-test="dkaa">dkaa</b></i>
		<dd id="dd0" data-test="aaadk">aaadk dd0</dd>
		<input id="c1" type="checkbox" value="c1" checked disabled>
		<dd id="dd1">dd1</dd>
		<dd id="dd2">dd2</dd>
		<dd id="dd3">
		<dt id="dt1">dt1</dt>
		</dd>
		<dl id="dl0">dl0
			<dd id="dd4">dd4</dd>
		</dl>
		<dl id="dl1">
			<dd id="dd5">dd5</dd>
		</dl>
		<dl id="dl2">
			<dt id="dt0">dt0</dt>
			<dd id="dd6">dd6</dd>
			<dd id="dd7">dd7</dd>
		</dl>
		<dl id="dl3">
			<dt id="dt1">dt1</dt>
		</dl>
		<a id="aa2" href="#" target="_blank">a_blank</a><a target="_self">a_self</a>
	</div>
	<div class='testBox'>
		<div class="title">loopTest</div>
		<div id="loop" class="data"></div>
		<div class="title">resizeTest</div>
		<div id="resize" class="data"></div>
		<div class="title">scrollText</div>
		<div id="scroll" class="data"></div>
	</div>
	<div id="detect" class='testBox'>
		<div class="title">디텍터</div>
	</div>
	<div id="json" class='testBox'>
		<div class="title">jsonTest</div>
	</div>
	<div id="xml" class='testBox'>
		<div class="title">xmlTest</div>
	</div>
	<div id="jsonp" class='testBox'>
		<div class="title">jsonpTest</div>
	</div>
	<div id="jsonp2" class='testBox'>
		<div class="title">jsonpTest2</div>
	</div>
</div>
<div style="clear:both"></div>

<div style="height:1000px;"></div>
<!--<div id="tween" style="background:#225544;position:absolute;top:0px;width:100px;height:100px"></div>-->


<script>

	//	alert('테스트용 파서 뭔가 있다!!')
	dk( function() {
//		///////////////////////////////////////////////////////////////
//		// 파서 테스트용 외부정의로 테스트
//		///////////////////////////////////////////////////////////////
		dk.fn( 'parseObj', function() {
			var data = arguments[0], parent = arguments[1], k, dom
			for( k in data ){
				dom = document.createElement( 'ul' )
				parent.appendChild( dom )
//				console.log(typeof data[k])
				if( data[k] instanceof Array ){
					dom.innerHTML = '<div class="array"><span>+</span> ' + k + ' : array </div>', dk.parseArray( data[k], dom )
				}
				else if( typeof data[k] == 'string' || typeof data[k] == 'number' ){
					if( dk.REG.url( data[k] ) || dk.REG.ip( data[k] ) ) dom.innerHTML = '<div class="data"><span></span> ' + k + ' : <a href="' + data[k] + '">' + data[k] + '</a></div>'
					else dom.innerHTML = '<div class="data"><span></span>' + k + ' : ' + data[k] + '</div>'
				} else dk.parseObj( data[k], dom ), console.log( 'obj 해석' )

			}
		} )
		dk.fn( 'parseArray', function() {
					var data = arguments[0], parent = arguments[1], dom

					for( var i = 0; i < data.length; i++ ){
						dom = document.createElement( 'ul' )
						parent.appendChild( dom )

						dk.addEvent( dom, 'mousedown', function( e ) {
							console.log( e.currentTarget )
							e.cancelBubble = true
							e.currentTarget.style.overflow='hidden'
							if( e.currentTarget.style.height != '20px' ) e.currentTarget .style.height = '20px'
							else e.currentTarget .style.height = '100%'
						})

						if( typeof data[i] == 'string' || typeof data[i] == 'number' ){
							if( dk.REG.url( data[i] ) || dk.REG.ip( data[i] ) ) dom.innerHTML = '<div class="data"><span>+</span> ' + i + ' : <a href="' + data[i] + '">' + data[i] + '</a></div>'
							else dom.innerHTML = '<div class="data"><span>+</span> ' + i + ' : ' + data[i] + '</div>'
						} else if( data[i] instanceof Array ) dom.innerHTML = '<div class="array"><span>+</span> ' + i + ' : array</div>', dk.parseArray( data[i], dom )
						else dom.innerHTML = '<div class="obj"><span>+</span> ' + i + ' : obj</div>', dk.parseObj( data[i], dom )
					}
				}
		)

		dk.parseObj( dk.DETECTOR, dk.selector( '#detect' )[0] )
		var loopTest = 0
		dk.LOOP.S( 'loop1', function() {
			dk.selector( '#loop' )[0].innerHTML = '' + loopTest++
		} )

		for( var i = 0; i < 5; i++ ){
			dk.LOOP.S( 'test' + i, (function() {
				var aa = i
				return function() {
//					console.log( 'test'+aa)
				}
			})() )

		}

		dk.WIN.RESIZE.S( 'resize1', function() {
			console.log( 'resize1', 'dk.WIN.width : ', dk.WIN.width, ' / dk.WIN.height : ', dk.WIN.height )
			dk.selector( '#resize' )[0].innerHTML = 'dk.WIN.width : ' + dk.WIN.width + ' / dk.WIN.height : ' + dk.WIN.height
			dk.selector( '#scroll' )[0].innerHTML = 'dk.WIN.scrollX : ' + dk.WIN.scrollX + ' / dk.WIN.scrollY : ' + dk.WIN.scrollY
		} )
		dk.WIN.RESIZE.S( 'resize2', function() {
			console.log( 'resize2' )
		} )
//
		dk.KEY.S( 'a', function( e ) {console.log( e, e.nativeEvent )} )
		dk.KEY.S( 'b', function() {console.log( 'a' )} )
		dk.KEY.S( 'c', function() {console.log( 'a' )} )

		console.log( dk.WIN.RESIZE.S( 'this' ) )
		console.log( dk.WIN.RESIZE.S( 'list' ) )

		var tester = function( k ) {
			console.log( k + ' : ', dk.selector( k ) )

		}

		var testList = ['p:lang(it)', 'dd:nth-child(even)', 'dd:nth-of-type(even)', 'dd:nth-child(odd)', 'dd:nth-of-type(odd)', 'dd:nth-child(1)', 'dd:nth-of-type(1)',
			'a:link', ':root', 'dt:only-child', 'dt:only-of-type', 'dd:last-of-type', 'dd:last-child',
			'[target=_blank]', 'p:empty', 'input:disabled', 'input:enabled', 'input:checked', 'dd:first-of-type', 'dd:first-child',
			'[data-test~=dk]', '[data-test~=dk]', '[data-test~=dk]', '[data-test*=dk]', '[data-test$=dk]', '[data-test^=dk]', '[data-test|=dk]',
			'[width]', 'i,dd', 'div ~ p ~ p', 'i b', 'i > b', 'p + span', '#a0', '#a0,#a1', '#a0,#a1,#a2', '.ka', 'span',
			'div ~ p', 'div > p', 'p > a', 'div > p > a', 'i > span > b', 'i > span', 'span > b', 'div.example > p > a', 'div ~ p ~ p'
		], i = testList.length;
		while( i-- ) tester( testList[i] );
//
		dk.js( jsCallBack, 'test1.js' )
		function jsCallBack() {
			console.log( '로딩완료-js콜백테스트' )
		}

		dk.js( null, 'test1.js', 'test2.js' )

		dk.get( getTest, 'test1.txt' )
		function getTest( data ) {
			console.log( '로딩완료-test1.txt', data )
		}

//
//		//	// openAPI로 연동했을때 callBack처리
		var str = dk.DETECTOR.browser == 'ie' ? encodeURIComponent( '언어의정원' ) : '언어의정원'

		function openAPICallBakcTest2( d ) {
			console.log( d.channel.q, d )
			dk.parseObj( d.channel, dk.selector( '#jsonp' )[0] )
		}

		dk.js( openAPICallBakcTest2, 'http://apis.daum.net/contents/movie?apikey=' + 'bffaf40ba59dff1a741998dd1d594e122f4260af&q=' + str + '&output=json&callback=' )

		function openAPICallBakcTest3( d ) {
			console.log( d.channel.q, d )
			dk.parseObj( d.channel, dk.selector( '#jsonp2' )[0] )
		}

		dk.js( openAPICallBakcTest3, 'http://apis.daum.net/contents/movie?apikey=' + 'bffaf40ba59dff1a741998dd1d594e122f4260af&q=' + 'RoboCop' + '&output=json&callback=' )

//
//		//		/// ajax test
		dk.get( null, 'test2.txt' )
//
		dk.WIN.SCROLL.S( 'scrollTest', function() {
			console.log( 'dk.WIN.scrollX : ', dk.WIN.scrollX, ' / dk.WIN.scrollY : ', dk.WIN.scrollY )
			dk.selector( '#scroll' )[0].innerHTML = 'dk.WIN.scrollX : ' + dk.WIN.scrollX + ' / dk.WIN.scrollY : ' + dk.WIN.scrollY
//		dk.selector( '#win' )[0].innerHTML = 'dk.WIN.width : ' + dk.WIN.width + ' / dk.WIN.height : ' + dk.WIN.height
//		dk.WIN.scroll(0,500)
		} );
//
//		// get을 이용한 제이슨/xml로딩 및 파싱테스트
		dk.get( getJSON_test, 'json/json.json' )
		function getJSON_test( d ) {
			console.log( d )
			var data = JSON.parse( d ), root = dk.selector( '#json' )[0]
			dk.parseObj( data, root )
		}

//
		dk.get( getXMLtest, 'json/test.xml' )
		function getXMLtest() {
			var root = dk.selector( '#xml' )[0], data = arguments[0]
			console.log( arguments[0] )
//		root.innerText = data
			data = parseToObject( data )
			dk.parseObj( data, root )
			function parseToObject() {
				var r = {}
				checkValue( arguments[0], r )
				function checkValue() {
					var i = 0, data = arguments[0], parent = arguments[1], len = data.childNodes.length, node, t0
					while( i < len ){
						var info = {}
						node = data.childNodes[i++]
						if( node.nodeType == 1 ){
							!parent[node.nodeName] ? t0 = parent[node.nodeName] = [] : 0,
									t0.push( info ), checkValue( node, info )
						} else if( node.nodeType == 3 || node.nodeType == 4 ) /\S/.test( node.nodeValue ) ? parent['value'] = node.nodeValue : 0
					}
				}

				console.log( r )
				return r
			}

		}

		dk.img( getImageTest, 'imgs/01.jpg', 'imgs/02.jpg', 'imgs/03.jpg', 'imgs/04.jpg', 'imgs/01.jpg', 'imgs/02.jpg', 'imgs/03.jpg', 'imgs/04.jpg' )
		function getImageTest( d ) {
			console.log( '이미지로드!', d )
			for( var i = 0; i < d.length; i++ ){
				var img = d[i]
				img.style.zIndex = 100
				img.style.position = 'absolute'
				img.style.top = (Math.random() * dk.WIN.height - img.width) + 'px'
				img.style.left = (Math.random() * dk.WIN.width - img.height) + 'px'
				document.body.appendChild( img )
			}

		}

		window['____callbacks' + 'test'] = function() {}
	} );


</script>
</body>
</html>
